import{S as ae,i as ne,s as oe,e as E,k as F,c as T,a as O,n as I,d as g,b as o,R as Q,f as X,D as f,T as q,U as Y,V as le,W as se,X as re,Y as ie,Z as $,_ as ue,t as de,O as ce,g as _e,$ as fe,w as he,x as pe,u as ve,a0 as me,a1 as x,r as be,a2 as ke,E as ge}from"../../chunks/vendor-d3152100.js";function C(u,{pending:t,error:e,result:a}){let h;async function j(p){const c=h={};p.preventDefault();const m=new FormData(u);t&&t(m,u);try{const r=await fetch(u.action,{method:u.method,headers:{accept:"application/json"},body:m});if(c!==h)return;r.ok?a(r,u):e?e(r,null,u):console.error(await r.text())}catch(r){if(e)e(null,r,u);else throw r}}return u.addEventListener("submit",j),{destroy(){u.removeEventListener("submit",j)}}}function ee(u,t,e){const a=u.slice();return a[6]=t[e],a[7]=t,a[8]=e,a}function te(u,t){let e,a,h,j,p,c,m,r,n,v,_,b,D,M,U,s,i,l,w,B,N,P,L,R,A,H=ge,y,W,Z;function z(...k){return t[3](t[6],t[7],t[8],...k)}function G(){return t[4](t[6],t[7],t[8])}function J(){return t[5](t[6])}return{key:u,first:null,c(){e=E("div"),a=E("form"),h=E("input"),p=F(),c=E("button"),v=F(),_=E("form"),b=E("input"),M=F(),U=E("button"),i=F(),l=E("form"),w=E("button"),L=F(),this.h()},l(k){e=T(k,"DIV",{class:!0});var d=O(e);a=T(d,"FORM",{action:!0,method:!0});var S=O(a);h=T(S,"INPUT",{type:!0,name:!0,class:!0}),p=I(S),c=T(S,"BUTTON",{class:!0,"aria-label":!0}),O(c).forEach(g),S.forEach(g),v=I(d),_=T(d,"FORM",{class:!0,action:!0,method:!0});var V=O(_);b=T(V,"INPUT",{"aria-label":!0,type:!0,name:!0,class:!0}),M=I(V),U=T(V,"BUTTON",{class:!0,"aria-label":!0}),O(U).forEach(g),V.forEach(g),i=I(d),l=T(d,"FORM",{action:!0,method:!0});var K=O(l);w=T(K,"BUTTON",{class:!0,"aria-label":!0}),O(w).forEach(g),K.forEach(g),L=I(d),d.forEach(g),this.h()},h(){o(h,"type","hidden"),o(h,"name","done"),h.value=j=t[6].done?"":"true",o(h,"class","svelte-16tkvjn"),o(c,"class","toggle svelte-16tkvjn"),o(c,"aria-label",m="Mark todo as "+(t[6].done?"not done":"done")),o(a,"action",r="/todos/"+t[6].uid+".json?_method=patch"),o(a,"method","post"),o(b,"aria-label","Edit todo"),o(b,"type","text"),o(b,"name","text"),b.value=D=t[6].text,o(b,"class","svelte-16tkvjn"),o(U,"class","save svelte-16tkvjn"),o(U,"aria-label","Save todo"),o(_,"class","text svelte-16tkvjn"),o(_,"action",s="/todos/"+t[6].uid+".json?_method=patch"),o(_,"method","post"),o(w,"class","delete svelte-16tkvjn"),o(w,"aria-label","Delete todo"),w.disabled=B=t[6].pending_delete,o(l,"action",N="/todos/"+t[6].uid+".json?_method=delete"),o(l,"method","post"),o(e,"class","todo svelte-16tkvjn"),Q(e,"done",t[6].done),this.first=e},m(k,d){X(k,e,d),f(e,a),f(a,h),f(a,p),f(a,c),f(e,v),f(e,_),f(_,b),f(_,M),f(_,U),f(e,i),f(e,l),f(l,w),f(e,L),y=!0,W||(Z=[q(n=C.call(null,a,{pending:z,result:t[1]})),q(C.call(null,_,{result:t[1]})),q(P=C.call(null,l,{pending:G,result:J}))],W=!0)},p(k,d){t=k,(!y||d&1&&j!==(j=t[6].done?"":"true"))&&(h.value=j),(!y||d&1&&m!==(m="Mark todo as "+(t[6].done?"not done":"done")))&&o(c,"aria-label",m),(!y||d&1&&r!==(r="/todos/"+t[6].uid+".json?_method=patch"))&&o(a,"action",r),n&&Y(n.update)&&d&1&&n.update.call(null,{pending:z,result:t[1]}),(!y||d&1&&D!==(D=t[6].text)&&b.value!==D)&&(b.value=D),(!y||d&1&&s!==(s="/todos/"+t[6].uid+".json?_method=patch"))&&o(_,"action",s),(!y||d&1&&B!==(B=t[6].pending_delete))&&(w.disabled=B),(!y||d&1&&N!==(N="/todos/"+t[6].uid+".json?_method=delete"))&&o(l,"action",N),P&&Y(P.update)&&d&1&&P.update.call(null,{pending:G,result:J}),d&1&&Q(e,"done",t[6].done)},r(){A=e.getBoundingClientRect()},f(){le(e),H(),se(e,A)},a(){H(),H=re(e,A,me,{duration:200})},i(k){y||(k&&ie(()=>{R||(R=$(e,x,{start:.7},!0)),R.run(1)}),y=!0)},o(k){k&&(R||(R=$(e,x,{start:.7},!1)),R.run(0)),y=!1},d(k){k&&g(e),k&&R&&R.end(),W=!1,ue(Z)}}}function je(u){let t,e,a,h,j,p,c,m,r,n=[],v=new Map,_,b,D,M=u[0];const U=s=>s[6].uid;for(let s=0;s<M.length;s+=1){let i=ee(u,M,s),l=U(i);v.set(l,n[s]=te(l,i))}return{c(){t=F(),e=E("div"),a=E("h1"),h=de("Todos"),j=F(),p=E("form"),c=E("input"),r=F();for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){ce('[data-svelte="svelte-181o7gf"]',document.head).forEach(g),t=I(s),e=T(s,"DIV",{class:!0});var l=O(e);a=T(l,"H1",{});var w=O(a);h=_e(w,"Todos"),w.forEach(g),j=I(l),p=T(l,"FORM",{class:!0,action:!0,method:!0});var B=O(p);c=T(B,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),B.forEach(g),r=I(l);for(let N=0;N<n.length;N+=1)n[N].l(l);l.forEach(g),this.h()},h(){document.title="Todos",o(c,"name","text"),o(c,"aria-label","Add todo"),o(c,"placeholder","+ tap to add a todo"),o(c,"class","svelte-16tkvjn"),o(p,"class","new svelte-16tkvjn"),o(p,"action","/todos.json"),o(p,"method","post"),o(e,"class","todos svelte-16tkvjn")},m(s,i){X(s,t,i),X(s,e,i),f(e,a),f(a,h),f(e,j),f(e,p),f(p,c),f(e,r);for(let l=0;l<n.length;l+=1)n[l].m(e,null);_=!0,b||(D=q(m=C.call(null,p,{result:u[2]})),b=!0)},p(s,[i]){if(m&&Y(m.update)&&i&1&&m.update.call(null,{result:s[2]}),i&3){M=s[0],be();for(let l=0;l<n.length;l+=1)n[l].r();n=fe(n,i,U,1,s,M,v,e,ke,te,null,ee);for(let l=0;l<n.length;l+=1)n[l].a();he()}},i(s){if(!_){for(let i=0;i<M.length;i+=1)pe(n[i]);_=!0}},o(s){for(let i=0;i<n.length;i+=1)ve(n[i]);_=!1},d(s){s&&g(t),s&&g(e);for(let i=0;i<n.length;i+=1)n[i].d();b=!1,D()}}}const we=async({fetch:u})=>{const t=await u("/todos.json");if(t.ok)return{props:{todos:await t.json()}};const{message:e}=await t.json();return{error:new Error(e)}};function Ee(u,t,e){let{todos:a}=t;async function h(r){const n=await r.json();e(0,a=a.map(v=>v.uid===n.uid?n:v))}const j=async(r,n)=>{const v=await r.json();e(0,a=[...a,v]),n.reset()},p=(r,n,v,_)=>{e(0,n[v].done=!!_.get("done"),a)},c=(r,n,v)=>e(0,n[v].pending_delete=!0,a),m=r=>{e(0,a=a.filter(n=>n.uid!==r.uid))};return u.$$set=r=>{"todos"in r&&e(0,a=r.todos)},[a,h,j,p,c,m]}class ye extends ae{constructor(t){super();ne(this,t,Ee,je,oe,{todos:0})}}export{ye as default,we as load};
